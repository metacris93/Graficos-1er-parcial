<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Proyecto de Graficos por Computadora 1</title>
  </head>
  <script src="js/jquery-2.2.3.min.js" type="text/javascript"></script>
  <script src="js/three.min.js" type="text/javascript"></script>
  <script src="js/controls/OrbitControls.js" type="text/javascript"></script>
  <script src='js/libs/dat.gui.min.js'></script>
  <script src='js/libs/stats.min.js'></script>
  <script src="js/objects/ShadowMesh.js"></script>
  <script type="text/javascript" src="variables.js"></script>
  <script type="text/javascript" src="funciones.js"></script>
  <style>
      body{
          /* set margin to 0 and overflow to hidden, to go fullscreen */
          margin: 0;
          overflow: hidden;
      }
      canvas { width: 100%; height: 100% }
  </style>
  <body>
      <div id="render"></div>
      <script type="text/javascript">
      /*
      * En esta funcion se crea el plano, enviando como parametros el alto, ancho y la imagen.
      * En caso de que la ruta de la imagen este vacio, se va crear un plano con un color predeterminado
      */
      function crear_plano(ancho , alto , imagen){
          if(imagen.length != 0){//si no se envia la ruta de la imagen

          }else{
            var geometria = new THREE.PlaneBufferGeometry(ancho, alto,1,1);
            var material = new THREE.MeshBasicMaterial({color: 'rgb(0,130,0)'});
            plano = new THREE.Mesh( geometria, material );
            plano.receiveShadow = true;
          }
      }

      function renderizar(){
        requestAnimationFrame( renderizar );
        renderer.render(scene, camara);
      }

      $(function (){
          renderer.setSize(window.innerWidth, window.innerHeight);
          renderer.setClearColor( 'rgb(186,228,218)' );
          $('#render').append(renderer.domElement);
          control_orbital = new THREE.OrbitControls(camara , renderer.domElement);
          control_orbital.addEventListener( 'change', renderizar );
          //renderer.shadowMapEnabled = true;
          crear_plano(15, 15,"");
          plano.rotation.x=-0.5*Math.PI;
          plano.position.x = 0;
          plano.position.y = -1 ;
          plano.position.z = 0;
          scene.add( plano );
          // se ubica la camara en el centro de la escena
          camara.position.x = -5;//-30
          camara.position.y = 5;
          camara.position.z = 0;
          camara.lookAt(scene.position);

          //iluminacion
          FuenteDeLuz.position.set( -30, 50, - 2 );
          FuenteDeLuz.lookAt( scene.position );
  				scene.add( FuenteDeLuz );
          PosicionLuz.x = FuenteDeLuz.position.x;
  				PosicionLuz.y = FuenteDeLuz.position.y;
  				PosicionLuz.z = FuenteDeLuz.position.z;
  				PosicionLuz.w = 0.001; //valor debe ser cercano a cero para mejores resultados, pero no cero, x problemas de divisi√≥n para cero.

          // Fin de iluminacion


  				agregar_cubo();

  				agregar_cilindro();

  				agregar_toroide();

  				agregar_esfera();

  				agregar_piramide();

          var controlador = new Controlador();
          gui_widget = new dat.GUI();
          var control = gui_widget.addColor(controlador , 'color').listen();
          control.onChange(function(value){
              plano.material.color.setHex( value.replace("#", "0x") );;
          });

          animacion();
      });

      window.addEventListener( 'resize', function () {

      camara.aspect = window.innerWidth / window.innerHeight;
      camara.updateProjectionMatrix();

      renderer.setSize( window.innerWidth, window.innerHeight );

      }, false );
      </script>
  </body>
</html>
