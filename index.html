<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Graficos 1er parcial</title>
  <style>
     body { margin: 0; }
     canvas { width: 100%; height: 100% }
  </style>
</head>
<body>
    <div id="render"></div>
    <script src="js/three.min.js" type="text/javascript"></script>
    <script src="js/controls/OrbitControls.js" type="text/javascript"></script>
    <script src="js/jquery-2.2.3.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/Detector.js"></script>
    <script src='js/libs/dat.gui.min.js'></script>
    <script type="text/javascript">
        /*
        Creando la funcionalidad
        inicio(): inicia toda la carga de los elementos graficos
        animar(): es la funcion que se repite para iniciar la animacion
        cargar_modelo(): construye los modelos o las especificaciones de los modelos
        render_modelo(): renderiza y modifica elementos graficos
        */
        if ( ! Detector.webgl ) Detector.addGetWebGLMessage();
        // render dentro del div
        var Render = new THREE.WebGLRenderer( { antialias: true } );
        //escenario
        var Escenario = new THREE.Scene();
        //camara
        var Camara = new THREE.PerspectiveCamera(30, window.innerWidth/window.innerHeight, 1, 10000);
        Camara.position.x = 1000;
				Camara.position.y = 50;
				Camara.position.z = 1500;
        Escenario.add(Camara);
        var Figura;
        var plano;
        var controls;
        var light;


        function renderer(){
           requestAnimationFrame( renderer );
           Render.render(Escenario, Camara);
        }

        function luz(){
            // lights
            var light, materials;
            Escenario.add( new THREE.AmbientLight( 0x666666 ) );
            light = new THREE.DirectionalLight( 0xdfebff, 1.75 );
            light.position.set( 50, 200, 100 );
            light.position.multiplyScalar( 1.3 );
            light.castShadow = true;
            light.shadow.mapSize.width = 1024;
            light.shadow.mapSize.height = 1024;
            var d = 300;
            light.shadow.camera.left = - d;
            light.shadow.camera.right = d;
            light.shadow.camera.top = d;
            light.shadow.camera.bottom = - d;
            light.shadow.camera.far = 1000;
            Escenario.add( light );
        }

        /********************************INICIO******************************************/
        function inicio(){
            Render.setSize(window.innerWidth, window.innerHeight);
            Render.setClearColor(0xdddddd);
            luz();
            controls = new THREE.OrbitControls( Camara, Render.domElement );
            controls.addEventListener( 'change', renderer );
            crear_plano();
            document.getElementById('render').appendChild(Render.domElement);
            crear_plano();
            camera.position.set( -20, 25, 50 );
        }
        function crear_plano(){
            var loader = new THREE.TextureLoader();
            var textura = loader.load(// resource URL
                      	'images/ajedrez.png',
                      	// Function when resource is loaded
                      	function ( texture ) {
                      		  var geometria_plano = new THREE.PlaneBufferGeometry(200,200);
                      		  var textura_plano = new THREE.MeshBasicMaterial( { map : texture , side: THREE.DoubleSide } );
                            plano = new THREE.Mesh( geometria_plano, textura_plano );
                            Escenario.add( plano );
                      	},
                      	// Function called when download progresses
                      	function ( xhr ) {
                      		console.log( (xhr.loaded / xhr.total * 100) + '% loaded' );
                      	},
                      	// Function called when download errors
                      	function ( xhr ) {
                      		console.log( 'An error happened' );
                      	});
                        loader.crossOrigin = "";
              textura.wrapS = textura.wrapT = THREE.RepeatWrapping;
            	textura.anisotropy = 16;
              textura.repeat.set(1,1);
        }

        window.addEventListener( 'resize', function () {

				Camara.aspect = window.innerWidth / window.innerHeight;
				Camara.updateProjectionMatrix();

				Render.setSize( window.innerWidth, window.innerHeight );

			  }, false );

        inicio();
        renderer();

    </script>
</body>
</html>
